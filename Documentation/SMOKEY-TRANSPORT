Let E be an encryption algorithm.
Let H be a hash function.
Let J be the Juggernaut protocol.
Let Je and Jm be the encryption and hash keys, respectively.
Let Pi be a public key.

A <----- J -----> B
A <----- E(M1 || P1, Je) || H(..., Jm) -----> B
A <----- P1(e1 || h1) || E(M2 || P2, e1) || H(..., h1) -----> B
...
A <----- Pi(ei || hi) || E(Mi || Pi, ei) || H(..., hi) -----> B
